<div class="menu-container" style="max-width: 1200px; margin: 0 auto">
  <div
    class="menu-header"
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #eee;
      padding-bottom: 15px;
    "
  >
    <div>
      <h2 style="margin: 0; color: #2c3e50; font-size: 1.8rem">Weekly Menu</h2>
      <p
        style="margin: 5px 0; color: #3498db; font-weight: bold; font-size: 1.1rem"
      >
        Week of {{ viewingDate | date : 'longDate' }}
      </p>
      <p *ngIf="!menuData && !loading" style="margin: 5px 0; color: #e74c3c; font-weight: bold">
        {{ error }}
      </p>
    </div>

    <div class="week-nav" style="display: flex; gap: 10px; align-items: center">
      <button (click)="changeWeek(-7)" class="nav-arrow-btn" title="Previous Week">&larr;</button>
      <button (click)="goToday()" class="nav-today-btn">Today</button>
      <button (click)="changeWeek(7)" class="nav-arrow-btn" title="Next Week">&rarr;</button>
    </div>
  </div>

  <div *ngIf="loading" style="text-align: center; padding: 50px">
    <p>Loading menu...</p>
  </div>

  <div
    *ngIf="menuData && !loading"
    class="grid-layout"
    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px"
  >
    <div
      *ngFor="let day of menuData.daily_menus"
      class="day-card"
      style="
        background: white;
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      "
    >
      <h4
        style="
          text-transform: capitalize;
          color: #2c3e50;
          margin-top: 0;
          border-bottom: 2px solid #ebf5fb;
          padding-bottom: 8px;
          margin-bottom: 15px;
        "
      >
        {{ day.day_of_week }}
      </h4>

      <div class="menu-options" style="display: flex; flex-direction: column; gap: 10px">
        <div class="menu-options" style="display: flex; flex-direction: column; gap: 10px">
          <button
            *ngIf="day.soup"
            (click)="selectItem(day.id, 'soup', day.soup.id)"
            [class.active]="selectedItems[day.id]?.['soup'] === day.soup.id"
            class="choice-btn"
          >
            <span class="label">Soup:</span> {{ day.soup?.name }}
          </button>

          <button
            *ngIf="day.entree_a"
            (click)="selectItem(day.id, 'entree_a', day.entree_a.id)"
            [class.active]="selectedItems[day.id]?.['entree_a'] === day.entree_a.id"
            class="choice-btn"
          >
            <span class="label">A:</span> {{ day.entree_a?.name }}
          </button>

          <button
            *ngIf="day.entree_b"
            (click)="selectItem(day.id, 'entree_b', day.entree_b.id)"
            [class.active]="selectedItems[day.id]?.['entree_b'] === day.entree_b.id"
            class="choice-btn"
          >
            <span class="label">B:</span> {{ day.entree_b?.name }}
          </button>

          <button
            *ngIf="day.dessert"
            (click)="selectItem(day.id, 'dessert', day.dessert.id)"
            [class.active]="selectedItems[day.id]?.['dessert'] === day.dessert.id"
            class="choice-btn"
          >
            <span class="label">Dessert:</span> {{ day.dessert?.name }}
          </button>

          <p
            *ngIf="!day.soup && !day.entree_a && !day.entree_b && !day.dessert"
            style="font-size: 0.8rem; color: #bdc3c7; font-style: italic; text-align: center"
          >
            No items scheduled
          </p>
        </div>
      </div>
    </div>
  </div>

  <div
    *ngIf="menuData"
    class="order-footer"
    style="
      margin-top: 40px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 12px;
      padding: 25px;
    "
  >
    <h4 style="margin-top: 0; color: #2c3e50">Donation & Options</h4>

    <div style="display: flex; flex-direction: column; gap: 12px">
      <label style="display: flex; align-items: center; gap: 10px; cursor: pointer">
        <input type="checkbox" [(ngModel)]="donateMeal" style="width: 18px; height: 18px" />
        <span>Donate one of my meals this week to someone in need</span>
      </label>

      <label style="display: flex; align-items: center; gap: 10px; cursor: pointer">
        <input type="checkbox" [(ngModel)]="consentUnclaimed" style="width: 18px; height: 18px" />
        <span>I consent to donating my meal if I do not pick it up</span>
      </label>
    </div>

    <button
      (click)="submitOrder()"
      style="
        margin-top: 25px;
        background: #27ae60;
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: bold;
        border-radius: 8px;
        cursor: pointer;
        width: 100%;
        transition: background 0.2s;
      "
    >
      Place Weekly Order
    </button>
  </div>
</div>
